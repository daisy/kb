<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>MathML</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="Guidelines for the provision of accessible MathML content.">
		<script>
			var page_info = {
				'category': ['HTML'],
				'appliesTo': ['Audiobooks*','EPUB3','EPUB2']
			};
		</script>
		<script src="/js/init.js"></script>
	</head>

	<body>
		<main>
			<div class="warning" role="note" aria-labelledby="use-warn">
				<p class="label" id="use-warn">Caution</p>
				<p>A solution for MathML that works in all reading systems does not currently exist. The techniques
					presented on this page will continue to be updated as new information becomes available.</p>
				<p>Refer to the <a 
					href="https://daisy.github.io/transitiontoepub/best-practices/mathML/mathMLBestPractices.html">Best
					Practices for Authoring MathML in EPUB</a> guide for the latest information.</p>
			</div>

			<section id="summary">
				<h3>Summary</h3>

				<p>Support for rendering of native MathML markup is increasing but workarounds may still be necessary
					in some support scenarios.</p>
			</section>

			<section id="tech">
				<h3>Techniques</h3>

				<ul>
					<li>
						<p>Represent math equations using MathML markup. [[WCAG-1.3.1]]</p>
					</li>
					<li>
						<p>Use the <code>math</code> role for plain text equations. [[WCAG-1.3.1]]</p>
					</li>
				</ul>
			</section>

			<section id="ex">
				<h3>Examples</h3>

				<figure id="ex-01">
					<figcaption>
						<div class="label">Example 1 &#8212; Block-level MathML equation</div>
					</figcaption>
					<pre id="ex-01-src" class="prettyprint linenums"><code>&lt;math xmlns="http://www.w3.org/1998/Math/MathML">
   &lt;mfrac>
      &lt;msqrt>
         &lt;mtext>a&lt;/mtext>
      &lt;/msqrt>
      &lt;mi>b&lt;/mi>
   &lt;/mfrac>
&lt;/math></code></pre>
					<p class="figlabel">Demo:</p>
					<math xmlns="http://www.w3.org/1998/Math/MathML">
						<mfrac>
							<msqrt>
								<mtext>a</mtext>
							</msqrt>
							<mi>b</mi>
						</mfrac>
					</math>
				</figure>
				
				<figure id="ex-02">
					<figcaption>
						<div class="label">Example 2 &#8212; Inline MathML equation</div>
					</figcaption>
					<pre id="ex-02-src" class="prettyprint linenums"><code>In the Pythagorean equation,
   &lt;math xmlns="http://www.w3.org/1998/Math/MathML">
      &lt;mrow>
         &lt;msup>
            &lt;mi>a&lt;/mi>
            &lt;mn>2&lt;/mn>
         &lt;/msup>
         &lt;mo>+&lt;/mo>
         &lt;msup>
            &lt;mi>b&lt;/mi>
            &lt;mn>2&lt;/mn>
         &lt;/msup>
         &lt;mo>=&lt;/mo>
         &lt;msup>
            &lt;mi>c&lt;/mi>
            &lt;mn>2&lt;/mn>
         &lt;/msup>
      &lt;/mrow>
   &lt;/math>,
   the sum of the square of &#8230;</code></pre>
					<p class="figlabel">Demo:</p>
					<p>In the Pythagorean Theorem, <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup></mrow></math>, the sum of the square &#8230;</p>
				</figure>
				
				<figure id="ex-03">
					<figcaption>
						<div class="label">Example 3 &#8212; Inline text math equation</div>
					</figcaption>
					<pre id="ex-03-src" class="prettyprint linenums"><code>If &lt;span role="math">2 + x = 9&lt;/span>,
   what is the value of &lt;var>x&lt;/var>?</code></pre>
					<p class="figlabel">Demo:</p>
					<p>If <span role="math">2 + x = 9</span>, what is the value if <var>x</var>?</p>
				</figure>
				
				<figure id="ex-04">
					<figcaption>
						<div class="label">Example 4 &#8212; Image with alternative text</div>
					</figcaption>
					<p>Note that although an image might be the only output, if a publisher has source MathML markup,
						it can be  kept together with the image in a (possibly hidden) <code>div</code>. Publishers
						could then choose which format to use in their published content (i.e., filtering out the
						less-supported alternative). It could also allow both forms to be published, with scripting
						used to determine which to render (note that a <a href="hidden.html#hidden-fallback">CSS
							fallback</a> might also be needed for the <code>hidden</code> attribute if older user
						agents like IE11 have to be accounted for).</p>
					<pre id="ex-04a-src" class="prettyprint linenums"><code>
&lt;div class="mathml-eq">
   &lt;img src="squarerootab.jpg" alt="Square root of the result of a divided by b"/>
   &lt;div hidden="hidden">
      &lt;math xmlns="http://www.w3.org/1998/Math/MathML">
         &lt;mfrac>
            &lt;msqrt>
               &lt;mtext>a&lt;/mtext>
            &lt;/msqrt>
            &lt;mi>b&lt;/mi>
         &lt;/mfrac>
      &lt;/math>
   &lt;/div>
&lt;/div></code></pre>
					<p>Alternatively, to avoid any processing or rendering impact, the MathML markup could be hidden
						in an HTML comment (<code>&lt;!-- --></code>). This may pose re-processing challenges
						later.</p>
					<pre id="ex-04b-src" class="prettyprint linenums"><code>
&lt;img src="squarerootab.jpg" alt="Square root of the result of a divided by b"/>
&lt;!-- &lt;math xmlns="http://www.w3.org/1998/Math/MathML">
         &lt;mfrac>
            &lt;msqrt>
               &lt;mtext>a&lt;/mtext>
            &lt;/msqrt>
            &lt;mi>b&lt;/mi>
         &lt;/mfrac>
      &lt;/math> --></code></pre>
				</figure>
			</section>

			<section id="faq">
				<h3>Frequently Asked Questions</h3>

				<dl>
					<dt>Should I prefix the MathML tags?</dt>
					<dd>
						<p>No, it is not recommended to use prefixes with math tags (e.g., <code>m:math</code>).</p>

						<p>Not all combinations of assistive technologies and user agents are XML aware, so even if they
							support MathML markup they may not support prefixed markup.</p>

						<p>The use of unprefixed tags is also recommended as it ensures compatibility between both HTML
							and XHTML syntaxes (XML prefixes are not supported in HTML).</p>
					</dd>
					
					<dt>Should I use the ARIA <code>math</code> role with MathML markup?</dt>
					<dd>
						<p>No, it is strongly advised not to use the <code>math</code> role with MathML markup. In many
							cases, using this role will cause the MathML markup not to be accessible to users.</p>
						<p>The <code>math</code> role should be restricted to text math equations (refer to 
							<a href="#ex-03">example 3</a>).</p>
					</dd>
					
					<dt>How can I provide a description?</dt>
					<dd>
						<p>There currently isn't a recommended practice for descriptions due to poor support.</p>
						<p>The <code>alttext</code> attribute is not intended for descriptions but to be used in
							place of the MathML when it is not supported. Reading systems support for this replacement
							is poor.</p>
						<p>MathML 4 is introducing the <a href="https://www.w3.org/TR/mathml4/#mixing_intent"><code>intent</code>
							attribute</a> to improve the voicing of equations, but it is still only a draft.</p>
						<p>It is possible to use the <code>aria-label</code> and <code>aria-details</code> attributes
							to provide a description, but more testing is necessary.</p>
						<p>This guide will be revised when a proven technique emerges.</p>
					</dd>
				</dl>
			</section>

			<section id="desc">
				<h3>Explanation</h3>

				<p>Although a benefit of native MathML support in HTML is the ability to provide voicing based on the
					markup, user agents capable of such voicings are still not widespread.
					MathML still presents the most accessible option in user agents that do support it, however.</p>

				<p>As MathML rendering support has now become widespread in browsers, the best option for providing
					accessible math equations is to use MathML markup.</p>
				
				<p>Although MathML should be preferred for math content, simple inline text equations are often not
					tagged (e.g., "<span role="math">x + y = z</span>"). Although such equations may appear simple,
					assistive technologies will often not read out all the symbols, making them difficult for users
					to understand. If MathML is not used for these types of equations, they should be wrapped inside
					an element with the role "<code>math</code>" (refer to <a href="#ex-03">example 3</a>). The use
					of this role allows assistive technologies to switch pronunciation modes.</p>
				
				<div class="note" role="note" aria-labelledby="epub-note">
					<p class="label" id="epub-note">Note</p>
					<p>Support for MathML in EPUB depends heavily on the age of the reading system. Reading systems
						that actively update their browser cores can now handle MathML, but publishers will still 
						have to consider the rendering of their content in older reading systems for a while.</p>
					<p>A less robust solution, but more likely to work in older reading systems, is to provide an image of
						the math with a sufficiently descriptive alternative text, and extended description for more 
						complex equations (refer to <a href="#ex-04">example 4</a>).</p>
					<p>For the most up-to-date information on support in EPUB, refer to the <a 
						href="https://daisy.github.io/transitiontoepub/best-practices/mathML/mathMLBestPractices.html">Best
						Practices for Authoring MathML in EPUB</a> guide.</p>
				</div>
			</section>

			<section id="refs">
				<h3>Related Links</h3>

				<ul>
					<li>MDN &#8212; <a
						href="https://developer.mozilla.org/en-US/docs/Web/MathML/Element/math">&lt;math></a></li>
					<li>MathML &#8212; <a href="http://www.w3.org/TR/MathML3/">Mathematical Markup Language (MathML)
							Version 3.0</a></li>
					<li>
						<a href="http://www.gh-mathspeak.com/examples/grammar-rules/">MathSpeak Core Specification
							Grammar Rules</a>
					</li>
					<li>DAISY &#8212; <a
						href="https://daisy.github.io/transitiontoepub/best-practices/mathML/mathMLBestPractices.html">Best Practices for
							Authoring MathML in EPUB</a></li>
				</ul>
			</section>
		</main>
	</body>
</html>
